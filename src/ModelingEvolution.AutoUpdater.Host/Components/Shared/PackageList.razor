@using ModelingEvolution.AutoUpdater
@inject DockerComposeConfigurationModel repo

<MudStack>
    <ObservableForEach ItemSource="@packages">
        
        <PackageDetails Package="@context" /> 
    </ObservableForEach>
</MudStack>

@code {
    [Parameter] public string ErrorMessage { get; set; } = string.Empty;

    private IReadOnlyList<DockerComposeConfiguration> packages = Array.Empty<DockerComposeConfiguration>();

    protected override void OnInitialized()
    {
        packages = repo.GetPackages();
    }

    protected override void OnParametersSet()
    {
        // Update error messages on all packages when global error changes
        if (packages == null!) return;
        foreach (var package in packages)
        {
            package.ErrorMessage = ErrorMessage;
        }
    }
}